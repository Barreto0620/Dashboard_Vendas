<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documenta√ß√£o Dashboard de Vendas</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link rel="icon" type="image/png" href="img/dashboard.png" />
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Barra de Progresso no Topo -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <header class="header">
        <div class="header-content">
            <a href="#overview" class="logo">
                <div class="logo-icon">
                    <img src="img/logo_webcash.png" alt="Logo WebCash">
                </div>
                <span class="logo-text">Dashboard de Vendas</span>
            </a>
            
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle">
                    <i id="theme-icon" class="fas fa-moon"></i>
                    <span id="theme-text">Dark</span>
                </button>
                <button class="mobile-menu-btn" id="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="mobile-overlay" id="mobile-overlay"></div>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-content">
            <h2 class="sidebar-title">Documenta√ß√£o</h2>
            <ul class="nav-menu">
                <li class="nav-item"><a href="#dashboard" class="nav-link"><i class="fas fa-chart-pie"></i> Dashboard</a></li>
                <li class="nav-item"><a href="#intro" class="nav-link"><i class="fas fa-book-open"></i> Introdu√ß√£o</a></li>
                <li class="nav-item"><a href="#chapter1" class="nav-link"><i class="fas fa-desktop"></i> Cap√≠tulo 1: Power BI</a></li>
                <li class="nav-item"><a href="#chapter2" class="nav-link"><i class="fas fa-search"></i> Cap√≠tulo 2: Fontes</a></li>
                <li class="nav-item"><a href="#chapter3" class="nav-link"><i class="fas fa-wrench"></i> Cap√≠tulo 3: Transforma√ß√£o</a></li>
                <li class="nav-item"><a href="#chapter4" class="nav-link"><i class="fas fa-project-diagram"></i> Cap√≠tulo 4: Modelo</a></li>
                <li class="nav-item"><a href="#chapter5" class="nav-link"><i class="fas fa-calculator"></i> Cap√≠tulo 5: DAX</a></li>
                <li class="nav-item"><a href="#chapter6" class="nav-link"><i class="fas fa-tachometer-alt"></i> Cap√≠tulo 6: KPIs</a></li>
                <li class="nav-item"><a href="#chapter7" class="nav-link"><i class="fas fa-chart-bar"></i> Cap√≠tulo 7: Visualiza√ß√µes</a></li>
            </ul>
        </div>
    </nav>

    <main class="main" id="main">
        <div class="content">
            <!-- Se√ß√£o do Dashboard Power BI -->
            <section id="dashboard" class="section">
                <h1>Visualiza√ß√£o Interativa de Vendas</h1>
                <p>Explore os dados de vendas em tempo real atrav√©s do nosso dashboard interativo desenvolvido em Power BI. Analise tend√™ncias, filtre por regi√µes, produtos e per√≠odos para obter insights valiosos sobre a performance do neg√≥cio.</p>
                <div class="dashboard-container">
                    <iframe title="dash_vendas" src="https://app.powerbi.com/view?r=eyJrIjoiMjE3MzZjYWItZDY5My00ZmNiLTlmODYtY2JiZmM0NTIyNjQwIiwidCI6IjgwYTM2ZDViLWI3YmItNDNkMS05ODgxLTI2YTcxMmE5MTU2ZCJ9" frameborder="0" allowFullScreen="true"></iframe>
                </div>
            </section>

            <section id="intro" class="section">
                <div class="hero">
                    <div class="hero-content">
                        <h1>Documenta√ß√£o Dashboard de Vendas</h1>
                        <p>Bem-vindo √† documenta√ß√£o completa do projeto <strong>Dashboard de Vendas</strong>, uma solu√ß√£o avan√ßada de Business Intelligence desenvolvida com Microsoft Power BI Desktop. Este guia t√©cnico detalhado o conduzir√° atrav√©s de todos os est√°gios do desenvolvimento, desde a importa√ß√£o e tratamento de dados brutos at√© a cria√ß√£o de visualiza√ß√µes interativas e indicadores-chave de performance (KPIs) que transformam n√∫meros em insights estrat√©gicos para o seu neg√≥cio.</p>
                        
                        <div class="features-grid">
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                                <h4>Analytics Avan√ßada</h4>
                                <p>Transforme dados complexos em insights acion√°veis com ferramentas de an√°lise profissional</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-database"></i></div>
                                <h4>Integra√ß√£o de Dados</h4>
                                <p>Conecte m√∫ltiplas fontes de dados e crie modelos relacionais robustos</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
                                <h4>KPIs Estrat√©gicos</h4>
                                <p>Monitore indicadores cr√≠ticos de performance em tempo real</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="chapter1" class="section">
                <h1>Cap√≠tulo 1: Power BI Desktop - Sua Plataforma de Desenvolvimento</h1>
                <div class="content-box highlight">
                    <p><strong>Power BI Desktop</strong> √© a ferramenta central para desenvolvimento de solu√ß√µes de Business Intelligence da Microsoft. Funciona como um ambiente integrado de desenvolvimento (IDE) onde voc√™ constr√≥i, testa e otimiza seus dashboards antes da publica√ß√£o.</p>
                </div>
                <h3>Arquitetura e Funcionalidades Principais</h3>
                <p>O Power BI Desktop integra tr√™s componentes fundamentais em uma √∫nica plataforma, cada um especializado em uma fase espec√≠fica do desenvolvimento de dashboards:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Vista de Relat√≥rio (Report View):</strong> Interface principal para cria√ß√£o e design de visualiza√ß√µes interativas, layouts responsivos e formata√ß√£o de dashboards</li>
                        <li><strong>Vista de Dados (Data View):</strong> Ambiente para inspe√ß√£o detalhada de dados, aplica√ß√£o de filtros contextuais e valida√ß√£o de qualidade dos datasets</li>
                        <li><strong>Vista de Modelo (Model View):</strong> Designer visual para defini√ß√£o de relacionamentos entre tabelas, configura√ß√£o de cardinalidades e otimiza√ß√£o de performance do modelo de dados</li>
                    </ul>
                </div>
                <h3>Benef√≠cios Empresariais</h3>
                <div class="content-box success">
                    <p>Elimina a depend√™ncia de relat√≥rios est√°ticos e planilhas limitadas, permitindo an√°lises din√¢micas e explora√ß√£o interativa de dados em tempo real. Reduz significativamente o tempo entre coleta de dados e tomada de decis√£o estrat√©gica.</p>
                </div>
                <h3>Integra√ß√£o no Ecossistema Microsoft</h3>
                <p>Power BI Desktop funciona como ponto de entrada para o ecossistema completo de Business Intelligence da Microsoft, integrando-se nativamente com:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Power BI Service:</strong> Plataforma cloud para publica√ß√£o e colabora√ß√£o</li>
                        <li><strong>Microsoft 365:</strong> Integra√ß√£o com Excel, SharePoint e Teams</li>
                        <li><strong>Azure Data Services:</strong> Conectividade com servi√ßos de dados em nuvem</li>
                        <li><strong>SQL Server:</strong> Conex√£o direta com bancos de dados corporativos</li>
                    </ul>
                </div>
            </section>
            
            <section id="chapter2" class="section">
                <h1>Cap√≠tulo 2: Fontes de Dados - Funda√ß√£o do Seu Dashboard</h1>
                <div class="content-box">
                    <p>As <strong>Fontes de Dados</strong> constituem a camada fundamental de qualquer solu√ß√£o de Business Intelligence. No Power BI, esta etapa envolve n√£o apenas a conex√£o com reposit√≥rios de dados, mas tamb√©m a configura√ß√£o de atualiza√ß√µes autom√°ticas e otimiza√ß√£o de performance de consultas.</p>
                </div>
                <h3>Estrat√©gia de Conectividade</h3>
                <p>O Power BI oferece dois modos principais de conex√£o, cada um com implica√ß√µes espec√≠ficas para performance e funcionalidade:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Import Mode:</strong> Carrega dados na mem√≥ria para m√°xima performance anal√≠tica, ideal para datasets at√© 1GB</li>
                        <li><strong>DirectQuery Mode:</strong> Mant√©m conex√£o ativa com fonte original, adequado para dados em tempo real e grandes volumes</li>
                        <li><strong>Composite Models:</strong> Combina ambas as abordagens para otimiza√ß√£o h√≠brida de performance</li>
                    </ul>
                </div>
                <h3>Categorias de Fontes de Dados Suportadas</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Categoria</th>
                                <th>Tipos de Fonte</th>
                                <th>Casos de Uso T√≠picos</th>
                                <th>Considera√ß√µes de Performance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Arquivos Locais</strong></td>
                                <td>Excel, CSV, JSON, XML, Parquet</td>
                                <td>Prot√≥tipos, dados hist√≥ricos, importa√ß√µes pontuais</td>
                                <td>Limitado a 1GB por arquivo</td>
                            </tr>
                            <tr>
                                <td><strong>Bancos de Dados</strong></td>
                                <td>SQL Server, Oracle, MySQL, PostgreSQL</td>
                                <td>Sistemas transacionais, data warehouses corporativos</td>
                                <td>Otimiza√ß√£o de consultas SQL cr√≠tica</td>
                            </tr>
                            <tr>
                                <td><strong>Servi√ßos Cloud</strong></td>
                                <td>Azure SQL, AWS Redshift, Google BigQuery</td>
                                <td>Arquiteturas de dados modernas, escalabilidade</td>
                                <td>Lat√™ncia de rede consider√°vel</td>
                            </tr>
                            <tr>
                                <td><strong>APIs e Web Services</strong></td>
                                <td>REST APIs, OData, Web Tables</td>
                                <td>Integra√ß√£o com SaaS, dados em tempo real</td>
                                <td>Rate limiting e autentica√ß√£o</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h3>Melhores Pr√°ticas para Configura√ß√£o</h3>
                <div class="content-box important">
                    <p><strong>Seguran√ßa e Governan√ßa:</strong> Sempre configure credenciais adequadas e implemente row-level security quando necess√°rio. Documente todas as fontes de dados para facilitar manuten√ß√£o e auditoria.</p>
                </div>
                <div class="professional-list">
                    <ul>
                        <li><strong>Otimiza√ß√£o de Consultas:</strong> Utilize views e stored procedures para preprocessar dados no servidor de origem</li>
                        <li><strong>Agendamento Inteligente:</strong> Configure atualiza√ß√µes durante hor√°rios de baixa utiliza√ß√£o</li>
                        <li><strong>Monitoramento Cont√≠nuo:</strong> Implemente alertas para falhas de atualiza√ß√£o e degrada√ß√£o de performance</li>
                    </ul>
                </div>
            </section>
            
            <section id="chapter3" class="section">
                <h1>Cap√≠tulo 3: Transforma√ß√£o de Dados com Power Query</h1>
                <div class="content-box highlight">
                    <p>O <strong>Power Query</strong> √© o motor de ETL (Extract, Transform, Load) integrado do Power BI, baseado no mecanismo M language. Oferece capacidades avan√ßadas de limpeza, transforma√ß√£o e enriquecimento de dados atrav√©s de uma interface visual intuitiva.</p>
                </div>
                <h3>Arquitetura do Power Query Editor</h3>
                <p>O ambiente de transforma√ß√£o √© estruturado em componentes especializados que trabalham em conjunto para processar dados de forma eficiente:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Query Pane:</strong> Lista hier√°rquica de todas as consultas, par√¢metros e fun√ß√µes do projeto</li>
                        <li><strong>Data Preview:</strong> Visualiza√ß√£o em tempo real dos dados durante o processo de transforma√ß√£o</li>
                        <li><strong>Applied Steps:</strong> Hist√≥rico sequencial e edit√°vel de todas as transforma√ß√µes aplicadas</li>
                        <li><strong>Formula Bar:</strong> Editor avan√ßado para customiza√ß√£o de c√≥digo M language</li>
                    </ul>
                </div>
                <h3>Opera√ß√µes de Transforma√ß√£o Essenciais</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Categoria</th>
                                <th>Opera√ß√µes</th>
                                <th>Aplica√ß√£o Pr√°tica</th>
                                <th>Impacto na Qualidade</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Limpeza de Dados</strong></td>
                                <td>Remove nulls, duplicatas, outliers</td>
                                <td>Prepara√ß√£o para modelagem estat√≠stica</td>
                                <td>Alto - elimina ru√≠dos</td>
                            </tr>
                            <tr>
                                <td><strong>Transforma√ß√£o Estrutural</strong></td>
                                <td>Pivot, Unpivot, Split Columns</td>
                                <td>Normaliza√ß√£o de estruturas complexas</td>
                                <td>Cr√≠tico - define granularidade</td>
                            </tr>
                            <tr>
                                <td><strong>Enriquecimento</strong></td>
                                <td>Calculated Columns, Custom Functions</td>
                                <td>Adi√ß√£o de m√©tricas derivadas</td>
                                <td>M√©dio - adiciona valor anal√≠tico</td>
                            </tr>
                            <tr>
                                <td><strong>Integra√ß√£o</strong></td>
                                <td>Merge, Append, Lookup</td>
                                <td>Combina√ß√£o de m√∫ltiplas fontes</td>
                                <td>Alto - cria vis√£o unificada</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h3>Otimiza√ß√£o de Performance</h3>
                <div class="content-box success">
                    <p><strong>Query Folding:</strong> O Power Query automaticamente "empurra" transforma√ß√µes compat√≠veis para o servidor de dados origem, reduzindo significativamente o tempo de processamento e uso de mem√≥ria local.</p>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span><i class="fas fa-code"></i> Exemplo de M Language - Limpeza Automatizada</span>
                        <button class="copy-btn" title="Copiar c√≥digo"><i class="fas fa-copy"></i> Copiar</button>
                    </div>
                    <pre><code>let
    Source = Excel.Workbook(File.Contents("C:\Data\Vendas.xlsx")),
    Vendas = Source{[Item="Vendas",Kind="Sheet"]}[Data],
    #"Promoted Headers" = Table.PromoteHeaders(Vendas),
    #"Removed Nulls" = Table.SelectRows(#"Promoted Headers", 
        each ([Produto] <> null and [Valor] <> null)),
    #"Changed Types" = Table.TransformColumnTypes(#"Removed Nulls", 
        {{"Data", type date}, {"Valor", Currency.Type}}),
    #"Added Custom" = Table.AddColumn(#"Changed Types", "Ano-M√™s", 
        each Date.ToText([Data], "yyyy-MM"))
in
    #"Added Custom"</code></pre>
                </div>
            </section>
            
            <section id="chapter4" class="section">
                <h1>Cap√≠tulo 4: Modelo de Dados - Arquitetura Anal√≠tica</h1>
                <div class="content-box">
                    <p>O <strong>Modelo de Dados</strong> representa a arquitetura l√≥gica que define como diferentes entidades de informa√ß√£o se relacionam e interagem dentro do seu dashboard. √â fundamentado nos princ√≠pios de modelagem dimensional, otimizado para consultas anal√≠ticas de alta performance.</p>
                </div>
                <h3>Fundamentos da Modelagem Dimensional</h3>
                <p>O Power BI utiliza o conceito de <strong>Star Schema</strong> como padr√£o arquitetural, organizando dados em estruturas otimizadas para an√°lise:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Tabelas Fato (Fact Tables):</strong> Cont√™m m√©tricas quantitativas e chaves estrangeiras para dimens√µes</li>
                        <li><strong>Tabelas Dimens√£o (Dimension Tables):</strong> Armazenam atributos descritivos para contextualiza√ß√£o e filtros</li>
                        <li><strong>Relacionamentos (Relationships):</strong> Definem como as tabelas se conectam logicamente</li>
                        <li><strong>Hierarquias (Hierarchies):</strong> Estabelecem n√≠veis de drill-down para explora√ß√£o anal√≠tica</li>
                    </ul>
                </div>
                <h3>Tipos de Relacionamentos e Cardinalidades</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Tipo de Relacionamento</th>
                                <th>Cardinalidade</th>
                                <th>Caso de Uso</th>
                                <th>Impacto na Performance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>One-to-Many (1:*)</strong></td>
                                <td>Um para muitos</td>
                                <td>Produto ‚Üí Vendas, Cliente ‚Üí Pedidos</td>
                                <td>Otimizado - padr√£o recomendado</td>
                            </tr>
                            <tr>
                                <td><strong>Many-to-Many (*:*)</strong></td>
                                <td>Muitos para muitos</td>
                                <td>Produtos ‚Üî Categorias complexas</td>
                                <td>Cuidado - pode impactar performance</td>
                            </tr>
                            <tr>
                                <td><strong>One-to-One (1:1)</strong></td>
                                <td>Um para um</td>
                                <td>Tabelas de refer√™ncia especializadas</td>
                                <td>Neutro - considere consolida√ß√£o</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h3>Otimiza√ß√£o e Melhores Pr√°ticas</h3>
                <div class="content-box important">
                    <p><strong>Dire√ß√£o de Filtros:</strong> Configure adequadamente a dire√ß√£o de propaga√ß√£o de filtros (Single/Both) para garantir que interactions funcionem corretamente sem comprometer performance.</p>
                </div>
                <div class="professional-list">
                    <ul>
                        <li><strong>Chaves Surrogate:</strong> Utilize chaves num√©ricas artificiais para otimizar joins e reduzir uso de mem√≥ria</li>
                        <li><strong>Tabelas de Data:</strong> Implemente sempre uma tabela de calend√°rio dedicada para an√°lises temporais</li>
                        <li><strong>Row-Level Security:</strong> Configure seguran√ßa em n√≠vel de linha quando necess√°rio, sem impactar usabilidade</li>
                    </ul>
                </div>
                <div class="architecture-diagram">
                    <div class="mermaid">
erDiagram
    VENDAS {
        int VendaID PK
        int ProdutoID FK
        int ClienteID FK
        date DataVenda
        decimal ValorVenda
        int Quantidade
    }
    PRODUTOS {
        int ProdutoID PK
        string NomeProduto
        int CategoriaID FK
        decimal PrecoUnitario
        string Fornecedor
    }
    CLIENTES {
        int ClienteID PK
        string NomeCliente
        string Cidade
        string Estado
        string Segmento
    }
    CATEGORIAS {
        int CategoriaID PK
        string NomeCategoria
        string Descricao
    }
    CALENDARIO {
        date Data PK
        int Ano
        int Mes
        string NomeMes
        int Trimestre
        int Semana
    }
    VENDAS ||--o{ PRODUTOS : "tem"
    VENDAS ||--o{ CLIENTES : "feita_por"
    PRODUTOS ||--o{ CATEGORIAS : "pertence_a"
    VENDAS ||--o{ CALENDARIO : "ocorre_em"
                    </div>
                </div>
            </section>
            
            <section id="chapter5" class="section">
                <h1>Cap√≠tulo 5: DAX - Linguagem de An√°lise de Dados</h1>
                <div class="content-box highlight">
                    <p><strong>DAX (Data Analysis Expressions)</strong> √© uma linguagem funcional especializada para c√°lculos anal√≠ticos em modelos de dados tabulares. Combina sintaxe similar ao Excel com poder computacional de bancos de dados anal√≠ticos, oferecendo capacidades avan√ßadas de agrega√ß√£o, filtros contextuais e intelig√™ncia de tempo.</p>
                </div>
                <h3>Arquitetura e Conceitos Fundamentais</h3>
                <p>DAX opera em dois contextos principais que determinam como os c√°lculos s√£o avaliados:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>Row Context:</strong> Avalia express√µes linha por linha, t√≠pico em Calculated Columns</li>
                        <li><strong>Filter Context:</strong> Define o conjunto de dados considerado para agrega√ß√µes, influenciado por filtros, slicers e relacionamentos</li>
                        <li><strong>Evaluation Context:</strong> Combina√ß√£o dos contextos anteriores, determinando o resultado final dos c√°lculos</li>
                        <li><strong>Context Transition:</strong> Convers√£o autom√°tica entre contextos durante a avalia√ß√£o de medidas</li>
                    </ul>
                </div>
                <h3>Categorias de Fun√ß√µes DAX</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Categoria</th>
                                <th>Fun√ß√µes Principais</th>
                                <th>Prop√≥sito</th>
                                <th>Exemplo de Uso</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Agrega√ß√£o</strong></td>
                                <td>SUM, AVERAGE, COUNT, MAX, MIN</td>
                                <td>C√°lculos estat√≠sticos b√°sicos</td>
                                <td>Receita Total, Ticket M√©dio</td>
                            </tr>
                            <tr>
                                <td><strong>Filtros</strong></td>
                                <td>FILTER, ALL, CALCULATE, RELATED</td>
                                <td>Manipula√ß√£o de contexto</td>
                                <td>Vendas do Ano Anterior</td>
                            </tr>
                            <tr>
                                <td><strong>Time Intelligence</strong></td>
                                <td>DATESYTD, SAMEPERIODLASTYEAR</td>
                                <td>An√°lises temporais</td>
                                <td>YTD, Crescimento Anual</td>
                            </tr>
                            <tr>
                                <td><strong>Itera√ß√£o</strong></td>
                                <td>SUMX, AVERAGEX, MAXX</td>
                                <td>C√°lculos linha por linha</td>
                                <td>Margem por Produto</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h3>Medidas Essenciais para Dashboard de Vendas</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span><i class="fas fa-calculator"></i> Medidas Fundamentais de Vendas</span>
                        <button class="copy-btn" title="Copiar c√≥digo"><i class="fas fa-copy"></i> Copiar</button>
                    </div>
                    <pre><code>// Receita Total
Receita Total = SUM(Vendas[ValorVenda])

// Ticket M√©dio
Ticket M√©dio = DIVIDE([Receita Total], DISTINCTCOUNT(Vendas[VendaID]))

// Crescimento vs Ano Anterior
Crescimento YoY = 
VAR ReceitaAtual = [Receita Total]
VAR ReceitaAnoAnterior = CALCULATE([Receita Total], SAMEPERIODLASTYEAR(Calendario[Data]))
RETURN
DIVIDE(ReceitaAtual - ReceitaAnoAnterior, ReceitaAnoAnterior)

// Ranking de Produtos
Ranking Produtos = RANKX(ALL(Produtos[NomeProduto]), [Receita Total], , DESC)</code></pre>
                </div>
            </section>
            
            <section id="chapter6" class="section">
                <h1>Cap√≠tulo 6: KPIs - Indicadores Estrat√©gicos de Performance</h1>
                <div class="content-box">
                    <p>Os <strong>Indicadores-Chave de Performance (KPIs)</strong> representam m√©tricas estrat√©gicas essenciais que fornecem uma vis√£o sint√©tica e acion√°vel do desempenho organizacional. No contexto de dashboards de vendas, funcionam como "sinais vitais" do neg√≥cio, oferecendo insights imediatos sobre sa√∫de financeira e operacional.</p>
                </div>
                <h3>Framework de KPIs para Vendas</h3>
                <p>Um dashboard de vendas eficiente deve contemplar KPIs que cobram diferentes aspectos do funil comercial:</p>
                <div class="professional-list">
                    <ul>
                        <li><strong>KPIs de Volume:</strong> M√©tricas quantitativas que medem escala e crescimento</li>
                        <li><strong>KPIs de Valor:</strong> Indicadores monet√°rios que avaliam rentabilidade e efici√™ncia</li>
                        <li><strong>KPIs de Efici√™ncia:</strong> Raz√µes e percentuais que mostram produtividade</li>
                        <li><strong>KPIs de Tend√™ncia:</strong> Compara√ß√µes temporais que indicam dire√ß√£o do neg√≥cio</li>
                    </ul>
                </div>
                <h3>Matriz de KPIs Estrat√©gicos</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>KPI</th>
                                <th>F√≥rmula DAX</th>
                                <th>Significado Estrat√©gico</th>
                                <th>Meta T√≠pica</th>
                                <th>Frequ√™ncia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Receita Total</strong></td>
                                <td><code>SUM(Vendas[ValorVenda])</code></td>
                                <td>Sa√∫de financeira geral do neg√≥cio</td>
                                <td>Crescimento 10-15% a.a.</td>
                                <td>Di√°ria</td>
                            </tr>
                            <tr>
                                <td><strong>Ticket M√©dio</strong></td>
                                <td><code>DIVIDE([Receita Total], [Qtd Vendas])</code></td>
                                <td>Valor m√©dio por transa√ß√£o</td>
                                <td>Crescimento 5% a.a.</td>
                                <td>Semanal</td>
                            </tr>
                            <tr>
                                <td><strong>Margem Bruta</strong></td>
                                <td><code>DIVIDE([Lucro Total], [Receita Total])</code></td>
                                <td>Efici√™ncia operacional e precifica√ß√£o</td>
                                <td>25-40% por setor</td>
                                <td>Mensal</td>
                            </tr>
                            <tr>
                                <td><strong>Taxa Crescimento</strong></td>
                                <td><code>DIVIDE([Receita] - [Receita AA], [Receita AA])</code></td>
                                <td>Momentum e sustentabilidade</td>
                                <td>Positiva consistente</td>
                                <td>Mensal</td>
                            </tr>
                            <tr>
                                <td><strong>Convers√£o</strong></td>
                                <td><code>DIVIDE([Vendas Fechadas], [Oportunidades])</code></td>
                                <td>Efic√°cia do processo comercial</td>
                                <td>20-30% por setor</td>
                                <td>Semanal</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <section id="chapter7" class="section">
                <h1>Cap√≠tulo 7: Visualiza√ß√µes Interativas - Storytelling com Dados</h1>
                <div class="content-box">
                    <p>As <strong>Visualiza√ß√µes Interativas</strong> transformam dados complexos em narrativas visuais compreens√≠veis, permitindo explora√ß√£o din√¢mica e descoberta de insights atrav√©s de intera√ß√µes intuitivas. Representam a camada de apresenta√ß√£o que traduz an√°lises t√©cnicas em informa√ß√µes acion√°veis para diferentes stakeholders.</p>
                </div>
                <h3>Princ√≠pios de Design para Dashboards</h3>
                <div class="professional-list">
                    <ul>
                        <li><strong>Progressive Disclosure:</strong> Apresente informa√ß√µes em n√≠veis hier√°rquicos, do geral para o espec√≠fico</li>
                        <li><strong>Consistency:</strong> Mantenha padr√µes visuais consistentes em cores, tipografia e layout</li>
                        <li><strong>Context Preservation:</strong> Garanta que filtros e sele√ß√µes mantenham contexto claro</li>
                        <li><strong>Performance First:</strong> Otimize para carregamento r√°pido e intera√ß√µes fluidas</li>
                    </ul>
                </div>
                <h3>Taxonomia de Visualiza√ß√µes para Vendas</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Categoria</th>
                                <th>Tipos de Visual</th>
                                <th>Melhor Uso</th>
                                <th>Limita√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Compara√ß√£o</strong></td>
                                <td>Column, Bar, Stacked Bar</td>
                                <td>Rankings, compara√ß√µes categ√≥ricas</td>
                                <td>M√°ximo 10-15 categorias</td>
                            </tr>
                            <tr>
                                <td><strong>Temporal</strong></td>
                                <td>Line, Area, Waterfall</td>
                                <td>Tend√™ncias, sazonalidade, evolu√ß√£o</td>
                                <td>Requer data cont√≠nua</td>
                            </tr>
                            <tr>
                                <td><strong>Distribui√ß√£o</strong></td>
                                <td>Pie, Donut, TreeMap</td>
                                <td>Propor√ß√µes, composi√ß√£o de total</td>
                                <td>Eficaz at√© 7 segmentos</td>
                            </tr>
                            <tr>
                                <td><strong>Correla√ß√£o</strong></td>
                                <td>Scatter, Bubble Chart</td>
                                <td>Rela√ß√µes entre vari√°veis</td>
                                <td>Requer vari√°veis num√©ricas</td>
                            </tr>
                            <tr>
                                <td><strong>Geogr√°fico</strong></td>
                                <td>Map, Filled Map, ArcGIS</td>
                                <td>An√°lise territorial de vendas</td>
                                <td>Dependente de geocodifica√ß√£o</td>
                            </tr>
                            <tr>
                                <td><strong>Hier√°rquico</strong></td>
                                <td>Matrix, Drill-down Charts</td>
                                <td>Explora√ß√£o multi-dimensional</td>
                                <td>Pode criar complexidade visual</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <h3>Interatividade e Cross-Filtering</h3>
                <div class="content-box highlight">
                    <p><strong>Cross-Filtering Engine:</strong> O Power BI utiliza um mecanismo sofisticado de filtros cruzados que propaga sele√ß√µes entre visuais automaticamente, criando uma experi√™ncia de explora√ß√£o intuitiva onde cada clique revela novas perspectivas dos dados.</p>
                </div>
                <div class="professional-list">
                    <ul>
                        <li><strong>Highlight vs Filter:</strong> Configure adequadamente se interactions devem filtrar ou apenas destacar dados</li>
                        <li><strong>Bidirectional Filters:</strong> Use com parcim√¥nia relacionamentos bidirecionais para evitar ambiguidade</li>
                        <li><strong>Drill-through Pages:</strong> Implemente p√°ginas de detalhe para an√°lises aprofundadas</li>
                        <li><strong>Bookmarks:</strong> Crie cen√°rios pr√©-definidos para facilitar apresenta√ß√µes</li>
                    </ul>
                </div>
                <h3>Arquitetura de Intera√ß√£o</h3>
                <div class="architecture-diagram">
                    <div class="mermaid">
                        graph TD
                            A[üë§ Usu√°rio Clica em Visual] --> B[‚öôÔ∏è Power BI Engine]
                            B --> C{Tipo de Intera√ß√£o}
                            C -->|Filter| D[üîç Aplica Filtro Global]
                            C -->|Highlight| E[‚ú® Destaque Visual]
                            C -->|Drill| F[üî≠ Navega√ß√£o Hier√°rquica]
                            
                            D --> G[üìä Recalcula Medidas DAX]
                            E --> H[üé® Atualiza Formata√ß√£o]
                            F --> I[üìÑ Carrega Nova P√°gina/N√≠vel]
                            
                            G --> J[üîÑ Atualiza Todos os Visuais]
                            H --> J
                            I --> J
                            
                            J --> K[üëÅÔ∏è Exibe Resultado ao Usu√°rio]
                            
                            style A fill:#F2C811,stroke:#004B87,stroke-width:3px,color:#004B87
                            style B fill:#00BCF2,stroke:#004B87,stroke-width:2px,color:#ffffff
                            style J fill:#107C10,stroke:#004B87,stroke-width:2px,color:#ffffff
                            style K fill:#6B69D6,stroke:#004B87,stroke-width:2px,color:#ffffff
                    </div>
                </div>
                <h3>Otimiza√ß√£o de Performance Visual</h3>
                <div class="content-box success">
                    <p><strong>Rendering Optimization:</strong> Power BI otimiza automaticamente o rendering de visuais baseado na viewport e dados vis√≠veis. Utilize t√©cnicas como sampling para grandes datasets e considere summarization tables para agrega√ß√µes complexas.</p>
                </div>
                <div class="professional-list">
                    <ul>
                        <li><strong>Visual Consolidation:</strong> Evite excesso de visuais por p√°gina - m√°ximo recomendado √© 6-8 visuais</li>
                        <li><strong>Data Reduction:</strong> Use top N filters e agrega√ß√µes quando apropriado</li>
                        <li><strong>Custom Visuals:</strong> Avalie impacto de performance antes de implementar visuais personalizados</li>
                        <li><strong>Mobile Optimization:</strong> Configure layouts responsivos para diferentes dispositivos</li>
                    </ul>
                </div>
                <h3>Casos de Uso Avan√ßados</h3>
                <div class="content-box important">
                    <p><strong>Dynamic Titles e Conditional Formatting:</strong> Utilize medidas DAX para criar t√≠tulos din√¢micos e formata√ß√£o condicional baseada em contexto, tornando dashboards mais informativos e visualmente impactantes.</p>
                </div>
                <div class="code-block">
                    <div class="code-header">
                        <span><i class="fas fa-paint-brush"></i> Formata√ß√£o Condicional Avan√ßada</span>
                        <button class="copy-btn" title="Copiar c√≥digo"><i class="fas fa-copy"></i> Copiar</button>
                    </div>
                    <pre><code>// T√≠tulo Din√¢mico para Visual
T√≠tulo Din√¢mico = 
VAR PeriodoSelecionado = 
    IF(
        HASONEVALUE(Calendario[Ano]),
        "Vendas " & SELECTEDVALUE(Calendario[Ano]),
        "Vendas - M√∫ltiplos Per√≠odos"
    )
VAR TotalVendas = FORMAT([Receita Total], "#,##0")
RETURN
PeriodoSelecionado & " - Total: R$ " & TotalVendas

// Cor Condicional para KPIs
Cor Performance = 
VAR PercentualMeta = DIVIDE([Receita Total], [Meta Mensal])
RETURN
SWITCH(
    TRUE(),
    PercentualMeta >= 1.1, "#107C10",  // Verde
    PercentualMeta >= 1.0, "#F2C811",  // Amarelo  
    PercentualMeta >= 0.9, "#FF8C00",  // Laranja
    "#D13438"                          // Vermelho
)

// Tooltip Customizado
Tooltip Detalhado = 
"Produto: " & SELECTEDVALUE(Produtos[NomeProduto]) & 
UNICHAR(10) & "Receita: " & FORMAT([Receita Total], "R$ #,##0") &
UNICHAR(10) & "Unidades: " & FORMAT([Qtd Vendas], "#,##0") &
UNICHAR(10) & "Margem: " & FORMAT([Margem %], "0.0%")</code></pre>
                </div>
                <h3>Testing e Valida√ß√£o</h3>
                <div class="content-box">
                    <p><strong>User Acceptance Testing:</strong> Sempre valide dashboards com usu√°rios finais reais, testando cen√°rios de uso t√≠picos e casos extremos. Documente feedback e implemente melhorias iterativamente.</p>
                </div>
                <div class="professional-list">
                    <ul>
                        <li><strong>Cross-browser Testing:</strong> Valide compatibilidade em diferentes navegadores e dispositivos</li>
                        <li><strong>Data Accuracy:</strong> Compare resultados com fontes autoritativas para garantir precis√£o</li>
                        <li><strong>Performance Benchmarking:</strong> Me√ßa tempos de carregamento em diferentes cen√°rios</li>
                        <li><strong>Accessibility Compliance:</strong> Garanta conformidade com padr√µes de acessibilidade</li>
                    </ul>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <p>&copy; 2025 Dashboard de Vendas - Todos os direitos reservados. | <a href="https://github.com/WebCash-inc" target="_blank">Visite nosso GitHub</a></p>
    </footer>

    <!-- Bot√£o de Retornar ao Topo -->
    <button id="back-to-top-btn" title="Voltar ao topo">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="https://unpkg.com/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
